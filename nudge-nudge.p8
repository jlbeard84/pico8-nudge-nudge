pico-8 cartridge // http://www.pico-8.com
version 15
__lua__
--game
level=1
gridsquare=8

--player
player={}
player.x=0
player.y=0

--blocks
blockcount=2
blocks={}

function _init()

	startpos=16
	
	for i=1,blockcount,1 do
		blocks[i]={ x=startpos*i,y=startpos*i }
	end

end

function moveplayer()
 
 mvmtx=0
 mvmty=0
 
 if btnp(0) then
 	mvmtx-=gridsquare
 elseif btnp(1) then
 	mvmtx+=gridsquare
 elseif btnp(2) then
  mvmty-=gridsquare
 elseif btnp(3) then
  mvmty+=gridsquare
 end
 
 player.x+=mvmtx
 player.y+=mvmty
 
 for i=1,blockcount,1 do
 

		if player.x < blocks[i].x+gridsquare and
 		player.x+gridsquare > blocks[i].x and
 		player.y < blocks[i].y+gridsquare and
 		player.y+gridsquare > blocks[i].y then
				blocks[i].x+=mvmtx
				blocks[i].y+=mvmty
			
				if checkedgecollision(blocks[i])==true then
					player.x-=mvmtx
					player.y-=mvmty
				end
			
				return
		end
 end	

 checkedgecollision(player)
end

function checkedgecollision(actor)
	if actor.x < 0 then
 	actor.x=0
 	sfx(0)
 	return true
 elseif actor.x > 127 then
 	actor.x=120
 	sfx(0)
 	return true
 elseif actor.y < 0 then
 	actor.y=0
 	sfx(0)
 	return true
 elseif actor.y > 119 then
 	actor.y=112
 	sfx(0)
 	return true
 end
 
 return false
end

function _update()
	moveplayer()
end

function drawhud()
	rectfill(0,120,127,127,0)
	rect(0,120,127,128,7)
	print("level "..level,2,122,7)
end

function drawactors()
	--player
	spr(001,player.x,player.y)
	
	for i=1,blockcount,1 do
		spr(005,blocks[i].x,blocks[i].y)
	end
	--test rock
	
end

function _draw()
	rectfill(0,0,127,119,3)
	drawactors()
	drawhud()
end

__gfx__
0000000000aaaa00cccccccccccccccccccccccc0004400000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000aaaaaa0c777777cc777777cc777777c0044540000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700aacaacaac7666c7cc766667cc76c667c0445444000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000aa1aa1aac761167cc7c1167cc761167c4544454500000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000aaaaaaaac761167cc7611c7cc761167c4454444400000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700a8aaaa8ac7c6667cc766667cc766c67c0444544000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000a8888a0c777777cc777777cc777777c0044440000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000aaaa00cccccccccccccccccccccccc0005400000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0005050500050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000b0500805007050070500705008050090500705001050216001f6001e6001c6001b6001b6001a6001a600196001960019600196001960019600196001960019600196001960019600196001960019600
010f00001c5500f550105500c5500c5500c550105501755015550185501655014550125500f5500d55017550155501355011550105500e5500c55005550000000000000000000000000000000000000000000000
001000000155001500015500150001550015000255000000025500000002550015000155000000015500000002550000000255000000015500000001550000000255000000025500000001570000000157000000
__music__
00 01024344

